# Steps to use Data Binding

## Changes to the layout file

1) Enclose the layout file in <layout></layout> tags

2) Create a Data element and declare a variable to bind the data against 
```xml
    <data>
        <variable
            name="aStudentModelInstance"
            type="com.konceptsandcode.basicdatabinding.StudentModel" />
    </data>
```

3) Use a property from the data class

```xml
  <TextView
      android:layout_width="fill_parent"
      android:layout_height="wrap_content"
      android:text="@{aStudentModelInstance.firstName}" />
```

## Changes to the main Activity

1) Inflate the layout
```java
        /*
            Inflate the layout using DataBindingUtil class to create a binding class instance. 
            
            The binding class ActivityMainBinding is generated and its name is inferred from the layout file name 
            (activity_main, in this case)

            As the layout file name is called "activity_main", the binding class generated is called ActivityMainBinding

            DataBindingUtil.setContentView() returns the ViewDataBinding base class,
            but the generated class name should be used here
         */
        ActivityMainBinding binding =
                DataBindingUtil.setContentView(this, R.layout.activity_main);
```


2) Get the data (in this case, lets just initialize a model)

```java
        StudentModel studentModel = new StudentModel("Keith", "Koncepts", 12);
```

3) Binding the data to the view

```java
        binding.setAStudentModelInstance(studentModel);
```

## Block diagram

<img src="https://github.com/konceptsandcode/Android/blob/master/DataBinding/BasicDataBinding/_misc/DataBinding.png">

## How it works

1. Main Activity runs

2. Set content view to activity_main using DataBindingUtil class
    This class generates a class called ActivityMainBinding (inferring the name from activity_main layout file)
    It looks at the data variable declared and the type specified and defines a setter method after the name of the declared data variable that accepts an argument of type as declared. This setter method can be used to set the model instance as in Step 4

3. Initialize/Populate the model (studentModel, in this case) within the program or by fetching the data from local data provider or by calling a Web API

4. Set the model instance (studentModel) using the setter generated by the DataBindingUtil class

5. aStudentModelInstance.firstName (of format \<data variable\>.\<property\>) attempts to find the first public member of StudentModel in the following order:
```java
            public String getFirstName();
 
            public String firstName();

            public String firstName;
```
In this case, since getFirstName() method is defined in StudentModel, aStudentModelInstance.firstName translates to studentModel.firstName which then calls studentModel.getFirstName() as it is defined in the StudentModel class. If none of the above matches, a data binding error occurs on compilation indicating that it cannot find an accessor.

## Exploring Relevant Files

The following files are either modified or generated by the Data Binding plugin.

app/build/intermediates/res/merged/debug/layout/activity_main.xml

```xml
<!--
  Enclose the original layout in a "layout" tag
-->
        
    <!-- In the data element declare a variable that can be used to bind against -->
    
                 
                               
                                                                       
           

    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="vertical"
         android:tag="layout/activity_main_0">

        <!--
            In the TextView tag,
            The id attribute can be removed as it does not have to be referenced from an
            Activity using findViewById() method

            android:id="@+id/firstName"
        -->

        <!--
            The Binding Library will find the first public member in the following order:

            public String getFirstName();

            public String firstName();

            public String firstName;

            If none of the above matches, there would be a data binding error on compilation
            saying that it cannot find an accessor
        -->
        <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:tag="binding_1"                  />

        <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:tag="binding_2"                 />

        <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:tag="binding_3"              />

    </LinearLayout>
         
<!-- From: file:/home/droid/onGit/Android/DataBinding/BasicDataBinding/app/src/main/res/layout/activity_main.xml -->
```
